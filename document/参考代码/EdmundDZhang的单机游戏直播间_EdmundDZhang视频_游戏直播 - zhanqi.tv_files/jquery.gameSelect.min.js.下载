+function(e){"use strict";var t=function(t,a){this.$element=e(t),this.options=e.extend({},this.DEFAULTS,a),this.aGameList=a.aGameList,this.oGameHash={},this.oGameLevelHash={},this.init()};t.DEFAULTS={},t.prototype={init:function(){this.fFormatGameHash(),this.view()},view:function(){var e=this;if(e.$element.append('<input class="js-game-select-id" type="hidden" name="'+e.options.postName+'" value="" />'),e.options.selectedId){e.$element.find(".js-game-select-id").val(e.options.selectedId);var t,a,i=e.fReturnGameIdPath(e.options.selectedId,[]);yp.each(i,function(n,s){a=s,t=0==s?0:i[s-1],e.fAppendGameSelect(t,s,n)}),e.fAppendGameSelect(e.options.selectedId,a+1)}else e.fAppendGameSelect(0,0)},bindEvent:function(){},fFormatGameHash:function(){var t=this;yp.each(t.aGameList,function(a,i){t.options.aFilterIds&&-1==e.inArray(a.id,t.options.aFilterIds)||(t.oGameHash[a.id]=i,a.fid?(t.oGameLevelHash["fid_"+a.fid]=t.oGameLevelHash["fid_"+a.fid]||[],t.oGameLevelHash["fid_"+a.fid].push(i)):(t.oGameLevelHash.fid_0=t.oGameLevelHash.fid_0||[],t.oGameLevelHash.fid_0.push(i)))})},fGetGameSelectHtml:function(e,t,a){var i=this,n="",s="fid_"+e,l=i.oGameLevelHash[s];return l?(n+='<option value="">选择游戏</option>',yp.each(l,function(e){n+=a&&i.aGameList[e]&&i.aGameList[e].id==a?'<option selected="selected" value="'+i.aGameList[e].id+'">'+i.aGameList[e].name+"</option>":'<option value="'+i.aGameList[e].id+'">'+i.aGameList[e].name+"</option>"}),n=i.options.useZqSelect?'<div class="select fl mlr5 js-game-select-item" data-level="'+t+'"><select name="gameId_'+e+'">'+n+"</select></div>":'<select class="fl mlr5 js-game-select-item" name="gameId_'+e+'" data-level="'+t+'">'+n+"</select>"):n},fAppendGameSelect:function(t,a,i){var n=this,s=n.fGetGameSelectHtml(t,a,i);if(!s)return!1;var l=e(s);n.$element.append(l),n.options.useZqSelect?(l.zqSelect({inputName:l.find("select").attr("name"),defaultVal:i}),l.on("selectChange",function(){n.fAfterGameSelected(l.data("selectVal")(),a)})):l.on("change",function(){n.fAfterGameSelected(l.val(),a)})},fAfterGameSelected:function(t,a){var i=this;!t&&a>0?i.$element.find(".js-game-select-id").val(i.$element.find('.js-game-select-item[data-level="'+(+a-1)+'"]').data("selectVal")()):i.$element.find(".js-game-select-id").val(t),yp.each(i.$element.find(".js-game-select-item"),function(t){var i=e(t);a<+i.data("level")&&i.remove()}),a+=1,i.fAppendGameSelect(t,a)},fReturnGameIdPath:function(e,t){var a=this;return e>0?(t.unshift(e),a.oGameHash[e]&&0<+a.aGameList[a.oGameHash[e]].fid?a.fReturnGameIdPath(+a.aGameList[a.oGameHash[e]].fid,t):t):t}};var a=e.fn.gameSelect;e.fn.gameSelect=function(a){var i=2<=arguments.length?[].slice.call(arguments,1):[];return this.each(function(){var n=e(this),s=n.data("GameSelect"),l=e.extend({},t.DEFAULTS,n.data(),"object"==typeof a&&a);s||n.data("GameSelect",s=new t(this,l)),"string"==typeof a&&s[a].apply(s,i)})},e.fn.gameSelect.Constructor=t,e.fn.gameSelect.noConflict=function(){return e.fn.gameSelect=a,this}}(window.jQuery);