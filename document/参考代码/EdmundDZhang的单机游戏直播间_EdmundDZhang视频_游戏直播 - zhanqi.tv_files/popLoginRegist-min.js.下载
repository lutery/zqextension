yp.use("loginModule, registModule, tabs",function(a,s,i){a.ready(function(){$("body").append('<div class="new-login-ibox" id="userLoginBox" style="display:none;">                        <div class="hd">                          <a href="javascript:;" class="close js-close"></a>                          <ul class="clearfix">                            <li class="active">                              <a href="javascript:;">登录</a>                            </li>                            <li>                              <a href="javascript:;" class="regist-link">注册</a>                            </li>                          </ul>                        </div>                        <div class="bd">                          <form class="js-login-form" action="/api/auth/user.login" autocomplete="off" id="yp-box-form">                            <div class="row js-input">                              <div class="input">                                <input type="text" class="inputs" name="account" data-valid="uname" maxlength="100" />                                <label class="input-labels">账号/手机号码</label>                              </div>                            </div>                            <div class="row js-input">                              <div class="input">                                <input type="password" class="inputs" name="password" data-valid="password" maxlength="40" />                                <label class="input-labels">登录密码</label>                              </div>                            </div>                            <div class="jyyz js-geetest-script"></div>                            <div class="btn-area">                              <button type="submit" class="blue-zs-btn js-pop-login-btn">登 录</button>                            </div>                            <div class="label-row clearfix">                              <a target="_blank" href="/user/findpwd" class="fr">找回密码</a>                              <i class="checkbox checkboxed dv js-checkbox"></i>                              <input type="checkbox" checked="checked" class="js-checkbox-hidden" style="display:none;" />                              <span class="dv">一个月内免登录</span>                            </div>                          </form>                          <div class="third-login">                            <ul class="clearfix">                              <li class="qq">                                <a class="js-third-login" href="/api/auth/user.other_login?type=qq">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>QQ</p>                              </li>                              <li class="wb">                                <a class="js-third-login" href="/api/auth/user.other_login?type=wb">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>微博</p>                              </li>                              <li class="wx">                                <a class="js-third-login" href="/api/auth/user.other_login?type=wx">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>微信</p>                              </li>                              <li class="tb">                                <a class="js-third-login" href="/api/auth/user.other_login?type=bd">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>百度贴吧</p>                              </li>                            </ul>                          </div>                        </div>                      </div>                      <div class="new-login-ibox new-register-ibox tabs" id="registerIbox" style="display: none;" data-close=".closeTab">                        <div class="hd">                          <a href="javascript:;" class="close js-close"></a>                          <ul class="clearfix">                            <li class="tab active">                              <a href="javascript:;">手机注册</a>                            </li>                            <li class="tab">                              <a href="javascript:;">普通注册</a>                            </li>                          </ul>                        </div>                        <div class="bd">                          <div class="tabc active">                            <form action="/api/auth/user.mobile_register" class="js-phone-form">                              <div class="row js-input">                                <div class="clearfix">                                  <div class="select js-select-panel">                                    <i class="arrow"></i>                                    <span class="js-regist-country-select js-select-txt">+86</span>                                    <input type="hidden" class="js-select-input" name="countryCode" value="+86">                                    <div class="option js-select-list">                                      <ul>                                        <li><a href="javascript:;" class="js-select-item" data-value="+86">中国大陆</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+852">香港</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+853">澳门</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+886">台湾</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+61">澳大利亚(Australia)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+1">加拿大(Canada)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+33">法国(France)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+49">德国(Germany)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+39">意大利(Italy)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+81">日本(Japan)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+82">韩国(Korea)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+60">马来西亚(Malaysia)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+64">新西兰(New Zealand)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+31">荷兰(Netherlands)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+7">俄罗斯(Russia)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+65">新加坡(Singapore)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+66">泰国(Thailand)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+44">英国(UK)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+1">美国(USA)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+84">越南(Vietnam)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+351">葡萄牙(Portugal)</a></li>                                        <li><a href="javascript:;" class="js-select-item" data-value="+62">印度尼西亚(Indonesia)</a></li>                                      </ul>                                    </div>                                  </div>                                  <div class="fr-input input">                                    <input type="text" class="inputs js-regist-phone" name="mobile" data-type="phone" />                                    <label class="input-labels">手机号码</label>                                  </div>                                </div>                              </div>                              <div class="js-phone-form-other-info" style="display:none;">                                <div class="row js-input clearfix">                                  <div class="clearfix">                                    <div class="input yzm-input">                                      <input type="text" class="inputs" name="code" data-type="phonecode">                                      <label class="input-labels">验证码</label>                                    </div>                                    <a href="javascript:;" class="yzm-btn js-regist-phone-code-btn">获取验证码</a>                                  </div>                                </div>                                <div class="row js-input">                                  <div class="input">                                    <input type="text" class="inputs required" name="nickname" data-type="nickname" />                                    <label class="input-labels">昵称</label>                                  </div>                                </div>                                <div class="row js-input">                                  <div class="input">                                    <input type="password" class="inputs required" name="password" data-type="password" />                                    <label class="input-labels">登录密码</label>                                  </div>                                </div>                              </div>                              <div class="jyyz js-geetest-mobile-script"></div>                              <div class="label-row">                                <i class="checkbox dv js-checkbox"></i>                                <input type="checkbox" class="dv terms-service-input js-checkbox-hidden" style="display:none;" />                                <span class="dv">阅读并接受<a href="/common/agreement.html" target="_blank">《战旗用户协议》</a></span>                              </div>                              <div class="btn-area">                                <button type="submit" class="blue-zs-btn login-btn">注 册</button>                              </div>                            </form>                          </div>                          <div class="tabc">                            <form action="/api/auth/user.register" class="js-normal-form">                              <div class="row js-input">                                <div class="input">                                  <input type="text" class="inputs required" name="account" data-type="account" />                                  <label class="input-labels">账号</label>                                </div>                              </div>                              <div class="row js-input">                                <div class="input">                                  <input type="text" class="inputs required" name="nickname" data-type="nickname" />                                  <label class="input-labels">昵称</label>                                </div>                              </div>                              <div class="row js-input">                                <div class="input">                                  <input type="password" class="inputs required" id="password-input" name="password" data-type="password" />                                  <label class="input-labels">密码</label>                                </div>                              </div>                              <div class="row js-input">                                <div class="input">                                  <input type="password" class="inputs required" id="password-input-confirm" data-type="password" data-confirm="1" />                                  <label class="input-labels">确认密码</label>                                </div>                              </div>                              <div class="jyyz js-geetest-normal-script"></div>                              <div class="label-row">                                <i class="checkbox dv js-checkbox"></i>                                <input type="checkbox" class="dv terms-service-input js-checkbox-hidden" style="display:none;" />                                <span class="dv">阅读并接受<a href="/common/agreement.html" target="_blank">《战旗用户协议》</a></span>                              </div>                              <div class="btn-area">                                <button type="submit" class="blue-zs-btn login-btn">注 册</button>                              </div>                            </form>                          </div>                          <p class="zc-p textR">已有账号？<a href="javascript:;" class="login-link">马上登录</a></p>                          <div class="third-login">                            <ul class="clearfix">                              <li class="qq">                                <a class="js-third-login" href="/api/auth/user.other_login?type=qq">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>QQ</p>                              </li>                              <li class="wb">                                <a class="js-third-login" href="/api/auth/user.other_login?type=wb">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>微博</p>                              </li>                              <li class="wx">                                <a class="js-third-login" href="/api/auth/user.other_login?type=wx">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>微信</p>                              </li>                              <li class="tb">                                <a class="js-third-login" href="/api/auth/user.other_login?type=bd">                                  <i class="icon"></i>                                  <i class="bg"></i>                                </a>                                <p>百度贴吧</p>                              </li>                            </ul>                          </div>                        </div>                      </div>');var l={};l.$loginModal=$("#userLoginBox"),l.$registModal=$("#registerIbox");var e={init:function(){this.view(),this.bindEvent(),this.listenYpEvent()},view:function(){},bindEvent:function(){var e=this;l.$loginModal.on("click",".js-close",function(a){a.preventDefault(),e.hideLoginModal(),s.hideModal()}),l.$registModal.on("click",".js-close",function(a){a.preventDefault(),e.hideRegistModal(),i.hideModal()}).tabs(),l.$loginModal.on("keydown.page.login",function(a){var i={esc:27},l=a.which;l==i.esc&&(e.hideLoginModal(),s.hideModal())}),l.$registModal.on("keydown.page.regist",function(a){var s={esc:27},l=a.which;l==s.esc&&(e.hideRegistModal(),i.hideModal())});var t,c=l.$loginModal.add(l.$registModal).find(".js-third-login"),n="";a.each(c,function(a){n="",t=$(a),window.pageType&&"login"==window.pageType?(n=getQueryString("redirect"),n&&(n=decodeURIComponent(n))):n=window.location.href,n&&t.attr("href",t.attr("href")+"&redirect="+n)})},listenYpEvent:function(){var l=this;a.sub("page/login",function(a){l.showLoginModal(),l.hideRegistModal()}),a.sub("page/regist",function(){l.hideLoginModal(),l.showRegistModal()}),a.sub("page/logout",function(){confirm('<div class="exit-content"></div>',function(){l.logout()},"",{title:"退出提示",width:388})}),a.sub("page/login/done",function(a){l.hideLoginModal(),s.hideModal()}),a.sub("page/regist/done",function(a){l.hideRegistModal(),i.hideModal()})},showLoginModal:function(){l.$loginModal.show().css({marginTop:0,top:$(window).scrollTop()+100})},hideLoginModal:function(){l.$loginModal.hide()},logouting:!1,logout:function(){var s=this;return s.logouting?!1:(s.logouting=!0,void a.ajax(oPageConfig.oUrl.sUrlLogout,{type:"post",dataType:"json"}).done(function(s){s.code||(oPageConfig.oLoginInfo=null,a.pub("page/logout/done")),s.message&&a.notify(s.message,s.code)}).fail(function(a,s,i){"timeout"==s&&alert("退出超时，请稍后再试")}).always(function(){s.logouting=!1}))},showRegistModal:function(){l.$registModal.show().css({marginTop:0,top:$(window).scrollTop()+100})},hideRegistModal:function(){l.$registModal.hide()}};e.init(),s.init(l.$loginModal),i.init(l.$registModal)})});