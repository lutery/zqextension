+function(){var i=window.oPageConfig,t=(i.oUrl,{}),e={loginExtraAction:null,oGeetest:null,bReflesh:!0,init:function(i){var t=this;t.view(i),t.listen(),t.create()},create:function(){var i=this;yp.sub("page/login",function(t,e){e?(i.loginExtraAction=e.extra,i.dataStatistics=e.dataStatistics):(i.loginExtraAction=null,i.dataStatistics=null),window.Geetest?i.oGeetest||yp.pub("page/geetest/loaded"):yp.pub("page/geetest/load"),i.showModal()}),yp.sub("page/regist",function(){i.hideModal()}),yp.sub("page/geetest/loaded",function(e){return i.oGeetest||!t.$loginModal?!1:(i.oGeetest=new window.Geetest({gt:"19565ca5c1c44cd27dd44930982ffccd",product:"float"}),i.oGeetest.appendTo(t.$loginModal.find(".js-geetest-script")),i.oGeetest.onRefresh(function(){i.bReflesh=!0}),void i.oGeetest.onSuccess(function(){i.bReflesh=!1,i.fFormSubmitAuto(t.$loginForm)}))})},view:function(i){t.$loginModal=i,t.$loginForm=t.$loginModal.find(".js-login-form"),t.$checkboxs=t.$loginForm.find(".js-checkbox")},listen:function(){var i=this;t.$loginForm.on("submit",function(e){e.preventDefault(),i.fFormSubmit(t.$loginForm)}),t.$checkboxs.on("click",function(i){i.preventDefault();var t=$(this),e=!t.hasClass("checkboxed");t.closest(".label-row").find(".js-checkbox-hidden").prop("checked",e),t.toggleClass("checkboxed",e)}),t.$loginModal.on("click",".regist-link",function(t){t.preventDefault(),i.dataStatistics?yp.pub("page/regist",{dataStatistics:i.dataStatistics}):yp.pub("page/regist")});var e="input",o=window.ie678;o&&(e="propertychange"),t.$loginModal.find(".inputs").on(e,function(){var i=$(this);""==i.val()?i.closest(".js-input").find(".input-labels").fadeIn():i.closest(".js-input").find(".input-labels").fadeOut()}).on("blur",function(){var i=$(this);""==i.val()&&i.closest(".js-input").find(".input-labels").fadeIn()}).on("focus",function(t){i.fValidSuccess($(this))}),t.$loginModal.find(".input-labels").on("click",function(i){i.preventDefault();var t=$(this);t.closest(".js-input").find(".inputs").focus()})},getUname:function(){return yp.localStorage.getItem("login-uname")||""},setUname:function(i){yp.localStorage.setItem("login-uname",i)},showModal:function(){var i=this;this.hideLoading(),t.$loginForm[0].reset(),yp.each(t.$loginForm.find(".js-input"),function(t){i.fValidSuccess($(t)),$(t).find(".input-labels").show()}),i.oGeetest&&!i.bReflesh&&i.oGeetest.refresh();var e=yp.login.getUname(),o=e?1:0,n=t.$loginModal.find(".js-input");n.eq(0).find("input").val(e),e&&n.eq(0).find(".input-labels").hide(),n.eq(o).find("input").focus()},hideModal:function(){var i=this;t.$loginModal.find(".yp-input-extra-action").remove(),i.dataStatistics=null,i.loginExtraAction=null,i.clearForm()},clearForm:function(){t.$loginModal.find(".inputs").val("")},showLoading:function(){t.$loginForm.find(".js-pop-login-btn").html("登录中...")},hideLoading:function(){t.$loginForm.find(".js-pop-login-btn").html("登录")},loginTimeout:8e3,fFormSubmitCheck:function(i,t){var e,o,n=this,a=!0,s={uname:n.fCheckAccount,password:n.fCheckPassword};return yp.each(i.find("[data-valid]"),function(i){o=$(i),e=s[o.data("valid")].call(n,o.val()),e.isok?t&&n.fValidSuccess(o):(a=!1,t&&n.fValidError(o,e.message))}),a?!0:!1},fFormSubmitDo:function(e){var o=this;if(o.loginExtraAction)for(var n=0,a=o.loginExtraAction.length;a>n;n++)t.$loginForm.append('<input class="yp-input-extra-action" type="hidden" name="'+o.loginExtraAction[n].name+'" value="'+o.loginExtraAction[n].value+'" />');o.showLoading(),e.data("ajaxing",!0).ajaxSubmit({timeout:o.loginTimeout}).ajax.done(function(e){if(0==e.code){o.loginTimeout=8e3;var n=t.$loginModal.find(".js-input:eq(0) input").val();yp.login.setUname(n),i.oLoginInfo=e.data,yp.pub("page/login/done",i.oLoginInfo),o.dataStatistics&&_hmt&&_hmt.push(o.dataStatistics)}else 11001==e.code?alert('<div class="ibox-msg">                    <div class="info">                      <div class="no-something-list">                        <i class="qn-logo dv"></i>                        <span class="text dv">您的账号存在异常暂时无法登录，若有疑问请 <a href="http://www.sobot.com/chat/pc/index.html?sysNum=fb175168d36b4614a3b4e2cb25f196ed" target="_blank">联系客服</a>。</span>                      </div>                    </div>                  </div>',"","",{width:500}):e.message&&yp.errorNotify(e.message);e.code&&setTimeout(function(){o.oGeetest&&o.oGeetest.refresh()},0)}).fail(function(i,t,e){"timeout"==t&&(alert("登录超时，请稍后再试"),o.loginTimeout=15e3)}).always(function(){o.hideLoading(),e.data("ajaxing",!1)})},fFormSubmit:function(i){var t=this,e=t.fFormSubmitCheck(i,!0);return!e||i.data("ajaxing")?!1:void t.fFormSubmitDo(i)},fFormSubmitAuto:function(i){var t=this,e=t.fFormSubmitCheck(i);return!e||i.data("ajaxing")?!1:void t.fFormSubmitDo(i)},fCheckAccount:function(i){var t={isok:!0,message:""};return""==i&&(t.isok=!1,t.message="请输入您的账号/手机号码"),t},fCheckPassword:function(i){var t={isok:!0,message:""};return""==i&&(t.isok=!1,t.message="请输入您的登录密码"),t},fValidSuccess:function(i){var e=i.closest(".js-input");e.removeClass("error"),e.data("errorid")&&(t.$loginModal.find("#error-"+e.data("errorid")).remove(),e.data("errorid",0))},fValidError:function(i,t){var e=this;if(i){var o=i.closest(".js-input");o.hasClass("error")&&e.fValidSuccess(i),o.addClass("error");var n=$.now(),a='<div class="title-area" id="error-'+n+'"><i class="icon dv"></i><span class="dv">'+t+"</span></div>";o.data("errorid",n).append(a)}},fGeetestError:function(i){var e=t.$loginModal.find(".js-geetest-script");e.hasClass("error")&&self.fGeetestSuccess(),e.addClass("error");var o=$.now(),n='<div class="title-area" id="error-'+o+'"><i class="icon dv"></i><span class="dv">'+i+"</span></div>";e.data("errorid",o).closest(".js-input").append(n)},fGeetestSuccess:function(){var i=t.$loginModal.find(".js-geetest-script");i.removeClass("error"),i.data("errorid")&&(t.$loginModal.find("#error-"+i.data("errorid")).remove(),i.data("errorid",0))}};"undefined"!=typeof module?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):window.oLogin=e}();